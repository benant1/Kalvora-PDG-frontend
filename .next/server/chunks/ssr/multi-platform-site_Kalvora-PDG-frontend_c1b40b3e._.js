module.exports=[64376,a=>{"use strict";let b=(0,a.i(48007).default)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);a.s(["AlertCircle",()=>b],64376)},69380,a=>{"use strict";let b=(0,a.i(48007).default)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);a.s(["CheckCircle2",()=>b],69380)},65915,a=>{"use strict";let b=(0,a.i(48007).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);a.s(["ArrowLeft",()=>b],65915)},12979,a=>{"use strict";let b=(0,a.i(48007).default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);a.s(["Loader2",()=>b],12979)},3244,a=>{"use strict";let b=(0,a.i(48007).default)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);a.s(["Upload",()=>b],3244)},23046,a=>{"use strict";let b=(0,a.i(48007).default)("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);a.s(["ImageIcon",()=>b],23046)},35311,a=>{"use strict";var b=a.i(81697),c=a.i(77138),d=a.i(81025),e=a.i(26998),f=a.i(3244),g=a.i(91816),h=a.i(12979),i=a.i(69380),j=a.i(64376),k=a.i(23046),l=a.i(65915),m=a.i(77068);let n=[{value:"template",label:"Template"},{value:"design",label:"Design"},{value:"service",label:"Service"},{value:"digital",label:"Produit Digital"},{value:"other",label:"Autre"}];function o(){let a=(0,d.useRouter)(),o=(0,d.useParams)().id,[p,q]=(0,c.useState)(!0),[r,s]=(0,c.useState)(!1),[t,u]=(0,c.useState)(""),[v,w]=(0,c.useState)(!1),[x,y]=(0,c.useState)({title:"",description:"",price:"",comparePrice:"",stock:"",category:"template",subcategory:"",status:"draft",metaTitle:"",metaDescription:""}),[z,A]=(0,c.useState)([]),[B,C]=(0,c.useState)([]),[D,E]=(0,c.useState)([]);(0,c.useEffect)(()=>{(async()=>{try{let b=localStorage.getItem("token");if(!b)return void a.push("/login");let c=await fetch(`http://localhost:4000/api/v1/vendor/products/${o}`,{headers:{Authorization:`Bearer ${b}`}});if(!c.ok)throw Error("Produit non trouvé");let d=await c.json();y({title:d.title||"",description:d.description||"",price:d.price?.toString()||"",comparePrice:d.comparePrice?.toString()||"",stock:d.stock?.toString()||"",category:d.category||"template",subcategory:d.subcategory||"",status:d.status||"draft",metaTitle:d.metaTitle||"",metaDescription:d.metaDescription||""}),A(d.images||[])}catch(a){console.error("Erreur:",a),u("Impossible de charger le produit")}finally{q(!1)}})()},[o,a]);let F=a=>{let{name:b,value:c}=a.target;y(a=>({...a,[b]:c})),u("")},G=async b=>{b.preventDefault(),u(""),s(!0);try{let b=localStorage.getItem("token");if(!b){u("Vous devez être connecté"),s(!1);return}if(!x.title||!x.price||!x.category||!x.description){u("Veuillez remplir tous les champs obligatoires"),s(!1);return}let c=new FormData;c.append("title",x.title),c.append("description",x.description),c.append("price",x.price),x.comparePrice&&c.append("comparePrice",x.comparePrice),c.append("stock",x.stock||"0"),c.append("category",x.category),x.subcategory&&c.append("subcategory",x.subcategory),c.append("status",x.status),x.metaTitle&&c.append("metaTitle",x.metaTitle),x.metaDescription&&c.append("metaDescription",x.metaDescription),c.append("existingImages",JSON.stringify(z)),B.forEach(a=>{c.append("images",a)});let d=await fetch(`http://localhost:4000/api/v1/vendor/products/${o}`,{method:"PUT",headers:{Authorization:`Bearer ${b}`},body:c}),e=await d.json();if(!d.ok)throw Error(e.error||"Erreur lors de la mise à jour");if("published"===x.status){let a=`${window.location.origin}/market/product/${o}`,c=z[0]||D[0]||"";try{await fetch("http://localhost:4000/api/v1/social/share-article",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${b}`},body:JSON.stringify({articleId:o,title:x.title,description:x.description,imageUrl:c,articleUrl:a})})}catch(a){console.warn("Social media share failed:",a)}}w(!0),setTimeout(()=>{a.push("/market/publication-space/dashboard/products")},1500)}catch(a){u(a.message||"Erreur lors de la mise à jour")}finally{s(!1)}};return p?(0,b.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,b.jsx)(h.Loader2,{className:"w-8 h-8 animate-spin text-primary"})}):v?(0,b.jsxs)("div",{className:"max-w-2xl mx-auto text-center py-20",children:[(0,b.jsx)("div",{className:"w-20 h-20 rounded-full bg-green-500/20 flex items-center justify-center mx-auto mb-6",children:(0,b.jsx)(i.CheckCircle2,{className:"w-10 h-10 text-green-500"})}),(0,b.jsx)("h1",{className:"text-3xl font-bold text-foreground mb-2",children:"Produit mis à jour!"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Les modifications ont été enregistrées."})]}):(0,b.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,b.jsxs)("div",{className:"mb-8",children:[(0,b.jsxs)(m.default,{href:"/market/publication-space/dashboard/products",className:"inline-flex items-center gap-2 text-muted-foreground hover:text-foreground mb-4",children:[(0,b.jsx)(l.ArrowLeft,{size:20}),"Retour aux produits"]}),(0,b.jsx)("h1",{className:"text-3xl font-bold text-foreground",children:"Modifier le produit"}),(0,b.jsx)("p",{className:"text-muted-foreground mt-1",children:"Modifiez les informations de votre produit"})]}),(0,b.jsxs)("form",{onSubmit:G,className:"space-y-8",children:[t&&(0,b.jsxs)("div",{className:"p-4 rounded-lg bg-red-500/10 border border-red-500/20 flex items-center gap-3",children:[(0,b.jsx)(j.AlertCircle,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),(0,b.jsx)("p",{className:"text-red-500",children:t})]}),(0,b.jsxs)("div",{className:"p-6 rounded-xl bg-card border border-border",children:[(0,b.jsxs)("h2",{className:"text-lg font-semibold text-foreground mb-4 flex items-center gap-2",children:[(0,b.jsx)(k.ImageIcon,{className:"w-5 h-5 text-primary"}),"Images du produit"]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-4",children:[z.map((a,c)=>(0,b.jsxs)("div",{className:"relative aspect-square rounded-lg overflow-hidden bg-muted",children:[(0,b.jsx)(e.default,{src:`http://localhost:4000${a}`,alt:`Image ${c+1}`,fill:!0,className:"object-cover"}),(0,b.jsx)("button",{type:"button",onClick:()=>{A(z.filter((a,b)=>b!==c))},className:"absolute top-2 right-2 p-1 bg-red-500 rounded-full text-white hover:bg-red-600 transition",children:(0,b.jsx)(g.X,{size:14})}),0===c&&(0,b.jsx)("span",{className:"absolute bottom-2 left-2 px-2 py-1 bg-primary text-xs text-white rounded",children:"Principal"})]},`existing-${c}`)),D.map((a,c)=>(0,b.jsxs)("div",{className:"relative aspect-square rounded-lg overflow-hidden bg-muted",children:[(0,b.jsx)(e.default,{src:a,alt:`Nouvelle image ${c+1}`,fill:!0,className:"object-cover"}),(0,b.jsx)("button",{type:"button",onClick:()=>{C(B.filter((a,b)=>b!==c)),E(D.filter((a,b)=>b!==c))},className:"absolute top-2 right-2 p-1 bg-red-500 rounded-full text-white hover:bg-red-600 transition",children:(0,b.jsx)(g.X,{size:14})}),(0,b.jsx)("span",{className:"absolute bottom-2 left-2 px-2 py-1 bg-green-500 text-xs text-white rounded",children:"Nouveau"})]},`new-${c}`)),z.length+B.length<10&&(0,b.jsxs)("label",{className:"aspect-square rounded-lg border-2 border-dashed border-border hover:border-primary cursor-pointer flex flex-col items-center justify-center gap-2 text-muted-foreground hover:text-primary transition",children:[(0,b.jsx)(f.Upload,{size:24}),(0,b.jsx)("span",{className:"text-xs text-center",children:"Ajouter"}),(0,b.jsx)("input",{type:"file",accept:"image/*",multiple:!0,onChange:a=>{let b=Array.from(a.target.files||[]);z.length+B.length+b.length>10?u("Maximum 10 images autorisées"):(C(a=>[...a,...b]),b.forEach(a=>{let b=new FileReader;b.onloadend=()=>{E(a=>[...a,b.result])},b.readAsDataURL(a)}))},className:"hidden"})]})]})]}),(0,b.jsxs)("div",{className:"p-6 rounded-xl bg-card border border-border",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-foreground mb-4",children:"Informations de base"}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Titre du produit *"}),(0,b.jsx)("input",{type:"text",name:"title",value:x.title,onChange:F,className:"w-full px-4 py-3 rounded-lg bg-background border border-border text-foreground focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none transition",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Description *"}),(0,b.jsx)("textarea",{name:"description",value:x.description,onChange:F,rows:5,className:"w-full px-4 py-3 rounded-lg bg-background border border-border text-foreground focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none transition resize-none",required:!0})]}),(0,b.jsxs)("div",{className:"grid sm:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Catégorie *"}),(0,b.jsx)("select",{name:"category",value:x.category,onChange:F,className:"w-full px-4 py-3 rounded-lg bg-background border border-border text-foreground focus:border-primary outline-none",required:!0,children:n.map(a=>(0,b.jsx)("option",{value:a.value,children:a.label},a.value))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Sous-catégorie"}),(0,b.jsx)("input",{type:"text",name:"subcategory",value:x.subcategory,onChange:F,className:"w-full px-4 py-3 rounded-lg bg-background border border-border text-foreground focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none transition"})]})]})]})]}),(0,b.jsxs)("div",{className:"p-6 rounded-xl bg-card border border-border",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-foreground mb-4",children:"Prix et stock"}),(0,b.jsxs)("div",{className:"grid sm:grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Prix (€) *"}),(0,b.jsx)("input",{type:"number",name:"price",value:x.price,onChange:F,step:"0.01",min:"0",className:"w-full px-4 py-3 rounded-lg bg-background border border-border text-foreground focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none transition",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Prix barré (€)"}),(0,b.jsx)("input",{type:"number",name:"comparePrice",value:x.comparePrice,onChange:F,step:"0.01",min:"0",className:"w-full px-4 py-3 rounded-lg bg-background border border-border text-foreground focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none transition"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Stock disponible"}),(0,b.jsx)("input",{type:"number",name:"stock",value:x.stock,onChange:F,min:"0",className:"w-full px-4 py-3 rounded-lg bg-background border border-border text-foreground focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none transition"})]})]})]}),(0,b.jsxs)("div",{className:"p-6 rounded-xl bg-card border border-border",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-foreground mb-4",children:"Publication"}),(0,b.jsxs)("div",{className:"flex gap-4",children:[(0,b.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,b.jsx)("input",{type:"radio",name:"status",value:"draft",checked:"draft"===x.status,onChange:F,className:"w-4 h-4 text-primary"}),(0,b.jsx)("span",{children:"Brouillon"})]}),(0,b.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,b.jsx)("input",{type:"radio",name:"status",value:"published",checked:"published"===x.status,onChange:F,className:"w-4 h-4 text-primary"}),(0,b.jsx)("span",{children:"Publié"})]}),(0,b.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,b.jsx)("input",{type:"radio",name:"status",value:"archived",checked:"archived"===x.status,onChange:F,className:"w-4 h-4 text-primary"}),(0,b.jsx)("span",{children:"Archivé"})]})]})]}),(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,b.jsx)("button",{type:"submit",disabled:r,className:"flex-1 inline-flex items-center justify-center gap-2 px-6 py-3 bg-gradient-to-r from-primary to-accent text-white rounded-lg hover:opacity-90 transition font-medium disabled:opacity-50",children:r?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(h.Loader2,{size:20,className:"animate-spin"}),"Enregistrement..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(i.CheckCircle2,{size:20}),"Enregistrer les modifications"]})}),(0,b.jsx)(m.default,{href:"/market/publication-space/dashboard/products",className:"px-6 py-3 border border-border rounded-lg hover:bg-muted transition font-medium text-center",children:"Annuler"})]})]})]})}a.s(["default",()=>o])}];

//# sourceMappingURL=multi-platform-site_Kalvora-PDG-frontend_c1b40b3e._.js.map