(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,27425,e=>{"use strict";let r=(0,e.i(52568).default)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["AlertCircle",()=>r],27425)},70928,e=>{"use strict";let r=(0,e.i(52568).default)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);e.s(["CheckCircle2",()=>r],70928)},14909,e=>{"use strict";let r=(0,e.i(52568).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>r],14909)},93158,e=>{"use strict";let r=(0,e.i(52568).default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>r],93158)},34263,e=>{"use strict";let r=(0,e.i(52568).default)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);e.s(["Upload",()=>r],34263)},20389,e=>{"use strict";let r=(0,e.i(52568).default)("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);e.s(["ImageIcon",()=>r],20389)},42203,e=>{"use strict";var r=e.i(63638),t=e.i(90634),s=e.i(50406),a=e.i(98420),i=e.i(34263),o=e.i(9251),l=e.i(93158),n=e.i(70928),d=e.i(27425),c=e.i(20389),u=e.i(14909),m=e.i(79214);let p=[{value:"template",label:"Template"},{value:"design",label:"Design"},{value:"service",label:"Service"},{value:"digital",label:"Produit Digital"},{value:"other",label:"Autre"}];function x(){let e=(0,s.useRouter)(),x=(0,s.useParams)().id,[g,h]=(0,t.useState)(!0),[b,f]=(0,t.useState)(!1),[y,j]=(0,t.useState)(""),[v,N]=(0,t.useState)(!1),[k,w]=(0,t.useState)({title:"",description:"",price:"",comparePrice:"",stock:"",category:"template",subcategory:"",status:"draft",metaTitle:"",metaDescription:""}),[C,P]=(0,t.useState)([]),[S,A]=(0,t.useState)([]),[z,T]=(0,t.useState)([]);(0,t.useEffect)(()=>{(async()=>{try{let r=localStorage.getItem("token");if(!r)return void e.push("/login");let t=await fetch(`http://localhost:4000/api/v1/vendor/products/${x}`,{headers:{Authorization:`Bearer ${r}`}});if(!t.ok)throw Error("Produit non trouvé");let s=await t.json();w({title:s.title||"",description:s.description||"",price:s.price?.toString()||"",comparePrice:s.comparePrice?.toString()||"",stock:s.stock?.toString()||"",category:s.category||"template",subcategory:s.subcategory||"",status:s.status||"draft",metaTitle:s.metaTitle||"",metaDescription:s.metaDescription||""}),P(s.images||[])}catch(e){console.error("Erreur:",e),j("Impossible de charger le produit")}finally{h(!1)}})()},[x,e]);let I=e=>{let{name:r,value:t}=e.target;w(e=>({...e,[r]:t})),j("")},D=async r=>{r.preventDefault(),j(""),f(!0);try{let r=localStorage.getItem("token");if(!r){j("Vous devez être connecté"),f(!1);return}if(!k.title||!k.price||!k.category||!k.description){j("Veuillez remplir tous les champs obligatoires"),f(!1);return}let t=new FormData;t.append("title",k.title),t.append("description",k.description),t.append("price",k.price),k.comparePrice&&t.append("comparePrice",k.comparePrice),t.append("stock",k.stock||"0"),t.append("category",k.category),k.subcategory&&t.append("subcategory",k.subcategory),t.append("status",k.status),k.metaTitle&&t.append("metaTitle",k.metaTitle),k.metaDescription&&t.append("metaDescription",k.metaDescription),t.append("existingImages",JSON.stringify(C)),S.forEach(e=>{t.append("images",e)});let s=await fetch(`http://localhost:4000/api/v1/vendor/products/${x}`,{method:"PUT",headers:{Authorization:`Bearer ${r}`},body:t}),a=await s.json();if(!s.ok)throw Error(a.error||"Erreur lors de la mise à jour");if("published"===k.status){let e=`${window.location.origin}/market/product/${x}`,t=C[0]||z[0]||"";try{await fetch("http://localhost:4000/api/v1/social/share-article",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({articleId:x,title:k.title,description:k.description,imageUrl:t,articleUrl:e})})}catch(e){console.warn("Social media share failed:",e)}}N(!0),setTimeout(()=>{e.push("/market/publication-space/dashboard/products")},1500)}catch(e){j(e.message||"Erreur lors de la mise à jour")}finally{f(!1)}};return g?(0,r.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,r.jsx)(l.Loader2,{className:"w-8 h-8 animate-spin text-primary"})}):v?(0,r.jsxs)("div",{className:"max-w-2xl mx-auto text-center py-20",children:[(0,r.jsx)("div",{className:"w-20 h-20 rounded-full bg-green-500/20 flex items-center justify-center mx-auto mb-6",children:(0,r.jsx)(n.CheckCircle2,{className:"w-10 h-10 text-green-500"})}),(0,r.jsx)("h1",{className:"text-3xl font-bold text-foreground mb-2",children:"Produit mis à jour!"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Les modifications ont été enregistrées."})]}):(0,r.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsxs)(m.default,{href:"/market/publication-space/dashboard/products",className:"inline-flex items-center gap-2 text-muted-foreground hover:text-foreground mb-4",children:[(0,r.jsx)(u.ArrowLeft,{size:20}),"Retour aux produits"]}),(0,r.jsx)("h1",{className:"text-3xl font-bold text-foreground",children:"Modifier le produit"}),(0,r.jsx)("p",{className:"text-muted-foreground mt-1",children:"Modifiez les informations de votre produit"})]}),(0,r.jsxs)("form",{onSubmit:D,className:"space-y-8",children:[y&&(0,r.jsxs)("div",{className:"p-4 rounded-lg bg-red-500/10 border border-red-500/20 flex items-center gap-3",children:[(0,r.jsx)(d.AlertCircle,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),(0,r.jsx)("p",{className:"text-red-500",children:y})]}),(0,r.jsxs)("div",{className:"p-6 rounded-xl bg-card border border-border",children:[(0,r.jsxs)("h2",{className:"text-lg font-semibold text-foreground mb-4 flex items-center gap-2",children:[(0,r.jsx)(c.ImageIcon,{className:"w-5 h-5 text-primary"}),"Images du produit"]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-4",children:[C.map((e,t)=>(0,r.jsxs)("div",{className:"relative aspect-square rounded-lg overflow-hidden bg-muted",children:[(0,r.jsx)(a.default,{src:`http://localhost:4000${e}`,alt:`Image ${t+1}`,fill:!0,className:"object-cover"}),(0,r.jsx)("button",{type:"button",onClick:()=>{P(C.filter((e,r)=>r!==t))},className:"absolute top-2 right-2 p-1 bg-red-500 rounded-full text-white hover:bg-red-600 transition",children:(0,r.jsx)(o.X,{size:14})}),0===t&&(0,r.jsx)("span",{className:"absolute bottom-2 left-2 px-2 py-1 bg-primary text-xs text-white rounded",children:"Principal"})]},`existing-${t}`)),z.map((e,t)=>(0,r.jsxs)("div",{className:"relative aspect-square rounded-lg overflow-hidden bg-muted",children:[(0,r.jsx)(a.default,{src:e,alt:`Nouvelle image ${t+1}`,fill:!0,className:"object-cover"}),(0,r.jsx)("button",{type:"button",onClick:()=>{A(S.filter((e,r)=>r!==t)),T(z.filter((e,r)=>r!==t))},className:"absolute top-2 right-2 p-1 bg-red-500 rounded-full text-white hover:bg-red-600 transition",children:(0,r.jsx)(o.X,{size:14})}),(0,r.jsx)("span",{className:"absolute bottom-2 left-2 px-2 py-1 bg-green-500 text-xs text-white rounded",children:"Nouveau"})]},`new-${t}`)),C.length+S.length<10&&(0,r.jsxs)("label",{className:"aspect-square rounded-lg border-2 border-dashed border-border hover:border-primary cursor-pointer flex flex-col items-center justify-center gap-2 text-muted-foreground hover:text-primary transition",children:[(0,r.jsx)(i.Upload,{size:24}),(0,r.jsx)("span",{className:"text-xs text-center",children:"Ajouter"}),(0,r.jsx)("input",{type:"file",accept:"image/*",multiple:!0,onChange:e=>{let r=Array.from(e.target.files||[]);C.length+S.length+r.length>10?j("Maximum 10 images autorisées"):(A(e=>[...e,...r]),r.forEach(e=>{let r=new FileReader;r.onloadend=()=>{T(e=>[...e,r.result])},r.readAsDataURL(e)}))},className:"hidden"})]})]})]}),(0,r.jsxs)("div",{className:"p-6 rounded-xl bg-card border border-border",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-foreground mb-4",children:"Informations de base"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Titre du produit *"}),(0,r.jsx)("input",{type:"text",name:"title",value:k.title,onChange:I,className:"w-full px-4 py-3 rounded-lg bg-background border border-border text-foreground focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none transition",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Description *"}),(0,r.jsx)("textarea",{name:"description",value:k.description,onChange:I,rows:5,className:"w-full px-4 py-3 rounded-lg bg-background border border-border text-foreground focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none transition resize-none",required:!0})]}),(0,r.jsxs)("div",{className:"grid sm:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Catégorie *"}),(0,r.jsx)("select",{name:"category",value:k.category,onChange:I,className:"w-full px-4 py-3 rounded-lg bg-background border border-border text-foreground focus:border-primary outline-none",required:!0,children:p.map(e=>(0,r.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Sous-catégorie"}),(0,r.jsx)("input",{type:"text",name:"subcategory",value:k.subcategory,onChange:I,className:"w-full px-4 py-3 rounded-lg bg-background border border-border text-foreground focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none transition"})]})]})]})]}),(0,r.jsxs)("div",{className:"p-6 rounded-xl bg-card border border-border",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-foreground mb-4",children:"Prix et stock"}),(0,r.jsxs)("div",{className:"grid sm:grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Prix (€) *"}),(0,r.jsx)("input",{type:"number",name:"price",value:k.price,onChange:I,step:"0.01",min:"0",className:"w-full px-4 py-3 rounded-lg bg-background border border-border text-foreground focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none transition",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Prix barré (€)"}),(0,r.jsx)("input",{type:"number",name:"comparePrice",value:k.comparePrice,onChange:I,step:"0.01",min:"0",className:"w-full px-4 py-3 rounded-lg bg-background border border-border text-foreground focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none transition"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Stock disponible"}),(0,r.jsx)("input",{type:"number",name:"stock",value:k.stock,onChange:I,min:"0",className:"w-full px-4 py-3 rounded-lg bg-background border border-border text-foreground focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none transition"})]})]})]}),(0,r.jsxs)("div",{className:"p-6 rounded-xl bg-card border border-border",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-foreground mb-4",children:"Publication"}),(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,r.jsx)("input",{type:"radio",name:"status",value:"draft",checked:"draft"===k.status,onChange:I,className:"w-4 h-4 text-primary"}),(0,r.jsx)("span",{children:"Brouillon"})]}),(0,r.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,r.jsx)("input",{type:"radio",name:"status",value:"published",checked:"published"===k.status,onChange:I,className:"w-4 h-4 text-primary"}),(0,r.jsx)("span",{children:"Publié"})]}),(0,r.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,r.jsx)("input",{type:"radio",name:"status",value:"archived",checked:"archived"===k.status,onChange:I,className:"w-4 h-4 text-primary"}),(0,r.jsx)("span",{children:"Archivé"})]})]})]}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,r.jsx)("button",{type:"submit",disabled:b,className:"flex-1 inline-flex items-center justify-center gap-2 px-6 py-3 bg-gradient-to-r from-primary to-accent text-white rounded-lg hover:opacity-90 transition font-medium disabled:opacity-50",children:b?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.Loader2,{size:20,className:"animate-spin"}),"Enregistrement..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.CheckCircle2,{size:20}),"Enregistrer les modifications"]})}),(0,r.jsx)(m.default,{href:"/market/publication-space/dashboard/products",className:"px-6 py-3 border border-border rounded-lg hover:bg-muted transition font-medium text-center",children:"Annuler"})]})]})]})}e.s(["default",()=>x])}]);